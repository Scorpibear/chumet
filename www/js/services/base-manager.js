angular.module("melissa.services")
  .value("base", 
{"m": "", "n": 0, "c": "b", "t": "wb", "e": {"v": 0.13, "d": 47}, "s": [
{"m": "e4", "n": 1, "c": "w", "e": {"v": 0.13, "d": 47}, "s": [
 {"m": "e6", "n": 1, "c": "b", "e": {"v": 0.06, "d": 44}, "s": [
  {"m": "d4", "n": 2, "c": "w", "e": {"v": 0.06, "d": 44}, "s": [
   {"m": "d5", "n": 2, "c": "b", "e": {"v": 0.14, "d": 44}, "s": [
    {"m": "Nd2", "n": 3, "c": "w", "e": {"v": 0.14, "d": 44}, "s": [
     {"m": "Nf6", "n": 3, "c": "b", "e": {"v": 0.4, "d": 44}, "s": [
      {"m": "e5", "n": 4, "c": "w", "e": {"v": 0.4, "d": 44}, "s": [
       {"m": "Nfd7", "n": 4, "c": "b", "e": {"v": 0.28, "d": 44}, "s": [
        {"m": "c3", "n": 5, "c": "w", "e": {"v": 0.2, "d": 46}, "s": [
         {"m": "c5", "n": 5, "c": "b", "e": {"v": 0.41, "d": 48}, "s": [
          {"m": "Bd3", "n": 6, "c": "w", "e": {"v": 0.41, "d": 48}, "s": [
           {"m": "cxd4", "n": 6, "c": "b", "e": {"v": 0.21, "d": 44}, "s": [
            {"m": "cxd4", "n": 7, "c": "w", "e": {"v": 0.41, "d": 42}, "s": [
             {"m": "Nc6", "n": 7, "c": "b", "e": {"v": 0.43, "d": 42}, "s": [
              {"m": "Ne2", "n": 8, "c": "w", "e": {"v": 0.33, "d": 42}, "s": [
               {"m": "f6", "n": 8, "c": "b", "e": {"v": 0.28, "d": 42}, "s": [
                {"m": "exf6", "n": 9, "c": "w", "e": {"v": 0.4, "d": 42}, "s": [
                 {"m": "Nxf6", "n": 9, "c": "b", "e": {"v": 0.19, "d": 36}, "s": [
                  {"m": "Nf3", "n": 10, "c": "w", "e": {"v": 0.27, "d": 36}, "s": [
                   {"m": "Bd6", "n": 10, "c": "b", "e": {"v": 0.4, "d": 36}, "s": []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},
{"m": "d4", "n": 1, "c": "w", "e": {"v": 0.13, "d": 44}, "s": [
 {"m": "Nf6", "n": 1, "c": "b", "e": {"v": 0.13, "d": 44}, "s": []}]},
{"m": "Nf3", "n": 1, "c": "w", "e": {"v": 0.14, "d": 36}, "s": [
 {"m": "Nf6", "n": 1, "c": "b", "e": {"v": 0.14, "d": 36}, "s": []}]},
{"m": "Nc3", "n": 1, "c": "w", "e": {"v": -0.18, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.18, "d": 36}, "s": []}]},
{"m": "c4", "n": 1, "c": "w", "e": {"v": 0.08, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": 0.08, "d": 36}, "s": []}]},
{"m": "f4", "n": 1, "c": "w", "e": {"v": -0.1, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.1, "d": 36}, "s": []}]},
{"m": "d3", "n": 1, "c": "w", "e": {"v": -0.25, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.25, "d": 36}, "s": []}]},
{"m": "g3", "n": 1, "c": "w", "e": {"v": 0.07, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": 0.07, "d": 36}, "s": []}]},
{"m": "b3", "n": 1, "c": "w", "e": {"v": 0.06, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": 0.06, "d": 36}, "s": []}]},
{"m": "b4", "n": 1, "c": "w", "e": {"v": -0.06, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.06, "d": 36}, "s": []}]},
{"m": "g4", "n": 1, "c": "w", "e": {"v": -0.93, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.93, "d": 36}, "s": []}]},
{"m": "e3", "n": 1, "c": "w", "e": {"v": 0.05, "d": 36}, "s": [
 {"m": "Nf6", "n": 1, "c": "b", "e": {"v": 0.05, "d": 36}, "s": []}]},
{"m": "f3", "n": 1, "c": "w", "e": {"v": -0.44, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": -0.44, "d": 36}, "s": []}]},
{"m": "h4", "n": 1, "c": "w", "e": {"v": -0.3, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": -0.3, "d": 36}, "s": []}]},
{"m": "Nh3", "n": 1, "c": "w", "e": {"v": -0.33, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": -0.33, "d": 36}, "s": []}]},
{"m": "a4", "n": 1, "c": "w", "e": {"v": -0.12, "d": 36}, "s": [
 {"m": "Nf6", "n": 1, "c": "b", "e": {"v": -0.12, "d": 36}, "s": []}]},
{"m": "c3", "n": 1, "c": "w", "e": {"v": 0, "d": 36}, "s": [
 {"m": "d5", "n": 1, "c": "b", "e": {"v": 0, "d": 36}, "s": []}]},
{"m": "h3", "n": 1, "c": "w", "e": {"v": 0, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": 0, "d": 36}, "s": []}]},
{"m": "a3", "n": 1, "c": "w", "e": {"v": 0, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": 0, "d": 36}, "s": []}]},
{"m": "Na3", "n": 1, "c": "w", "e": {"v": -0.27, "d": 36}, "s": [
 {"m": "e5", "n": 1, "c": "b", "e": {"v": -0.27, "d": 36}, "s": []}]}]}
  )
  .constant("localStorage", localStorage)
  .constant("JSON", JSON)
  .constant("localStorageItemForBase", "base")
  .factory("baseManager", ["base", "localStorageItemForBase", "localStorage", "JSON",
    function(base, localStorageItemForBase, localStorage, JSON) {
    return {
      restoreBase: function() {
        base.pgn = '';
        var baseFromLocalStorage = localStorage.getItem(localStorageItemForBase);
        if(baseFromLocalStorage) {
          try {
            base = JSON.parse(baseFromLocalStorage);
          } catch (err) {
            console.error("Could not parse base from local storage", baseFromLocalStorage);
          }
        }
        return base;
      },
      saveBase: function(base) {
        localStorage.setItem(localStorageItemForBase, JSON.stringify(base));
      }
    }
  }]);
